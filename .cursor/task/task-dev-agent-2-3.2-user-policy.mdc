# Задача 3.2: Policy для User (менеджеры)

## Ответственный агент
**dev_agent_2**

## Этап
Этап 3: Авторизация и политики

## Зависимости
- Задача 2.1 (Расширение User) - должна быть завершена

## Описание
Создать Policy для авторизации операций с менеджерами (User модель).

## Файлы для создания
- `app/Policies/UserPolicy.php` (новый файл)

## Требования
Реализовать методы авторизации:
- `viewAny(User $user)`: 
  - Только супер-менеджер и админ могут просматривать список менеджеров
  - Менеджер не имеет доступа
- `view(User $user, User $manager)`:
  - Только супер-менеджер и админ могут просматривать менеджера
- `create(User $user)`:
  - Только супер-менеджер и админ могут создавать менеджеров
- `update(User $user, User $manager)`:
  - Только супер-менеджер и админ могут обновлять менеджеров
- `delete(User $user, User $manager)`:
  - Только супер-менеджер и админ могут удалять менеджеров
- `changePassword(User $user, User $manager)`:
  - Только супер-менеджер и админ могут менять пароль менеджера
- `changeManager(User $user)`:
  - Только супер-менеджер и админ могут менять менеджера у клиента

## Ссылки на документацию
- См. `PLAN.mdc` - Задача 3.2
- См. `ARC.mdc` - раздел 3.5 (UserPolicy)
- Использовать `search-docs` для Laravel Policies

## Критерии приемки
- [ ] Файл `app/Policies/UserPolicy.php` создан
- [ ] Реализованы все методы авторизации
- [ ] Логика доступа соответствует требованиям PRD
- [ ] Policy зарегистрирована в `app/Providers/AuthServiceProvider.php` или через автодискавери
- [ ] Код соответствует стандартам Laravel
- [ ] Задача задокументирована в `workflow.mdc`

## Примечания
Можно выполнять параллельно с задачей 3.1
