# Задача 11.2: Тесты для ManagerController

## Ответственный агент
**qa_agent**

## Этап
Этап 11: Тестирование

## Зависимости
- Задача 5.2 (ManagerController) - должна быть завершена

## Описание
Создать feature тесты для ManagerController с проверкой прав доступа.

## Файлы для создания
- `tests/Feature/ManagerControllerTest.php` (новый файл)

## Требования

### Тестовые сценарии:
1. **Менеджер:**
   - Не может просматривать список менеджеров (403 Forbidden)
   - Не может создавать менеджеров
   - Не может обновлять менеджеров
   - Не может удалять менеджеров

2. **Супер-менеджер:**
   - Может просматривать список менеджеров
   - Может создавать менеджеров (manager, super_manager)
   - Может обновлять менеджеров
   - Может удалять менеджеров с передачей клиентов
   - Может менять пароль менеджеров
   - Может переключать флаг активности

3. **Администратор:**
   - Те же права, что и у супер-менеджера

4. **Общие тесты:**
   - Валидация данных при создании/обновлении
   - Проверка передачи клиентов при удалении менеджера
   - Проверка хеширования паролей
   - Поиск и сортировка работают корректно

### Использование:
- Pest PHP для написания тестов
- Factories для создания тестовых данных
- `actingAs()` для авторизации пользователей с разными ролями

## Ссылки на документацию
- См. `PLAN.mdc` - Задача 11.2
- См. `ARC.mdc` - раздел 8 (Тестирование)
- Использовать `search-docs` для Pest PHP и Laravel Testing

## Критерии приемки
- [ ] Файл `tests/Feature/ManagerControllerTest.php` создан
- [ ] Реализованы тесты для всех ролей
- [ ] Тесты проверяют права доступа
- [ ] Тесты проверяют валидацию
- [ ] Тесты проверяют передачу клиентов при удалении
- [ ] Все тесты проходят успешно (`php artisan test`)
- [ ] Код соответствует стандартам Pest PHP
- [ ] Задача задокументирована в `workflow.mdc`

## Примечания
Можно выполнять параллельно с задачей 11.1
